<!DOCTYPE html>
<html lang="en" ng-app="app">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            justify-content: center;
            align-items: center;
            color: white;
            display: flex;
            background-color: rgb(67, 73, 87);
            font-family: 'Roboto', sans-serif;
        }
        #list {
            background-color: #202124;
            height: 750px;
            width: 500px;
            border: 2px solid black;
            padding: 40px;
            margin: 30px;
            border-radius: 2%;
        }
        #title {
            border: none;
            width: 95%;
            height: 50px;
            padding-left: 15px;
            border-bottom: 2px solid aqua;
            margin: 2px;
            outline: none;
            color: white;
            font-weight: 700;
            font-size: x-large;
            font-family: 'Roboto', sans-serif;
            background: transparent;
        }
        .checkbox {
            background-color: rgb(67, 73, 87);
            width: 95%;
            height: 40px;
            margin: 20px;
            padding: 1%;
            display: flex;
            align-items: center;
            gap: 10px;
            border-radius: 5px;
        }
        .checkbox input[type="text"]::placeholder {
            color: #aaa;
        }
        .checkbox input[type="text"] {
            flex: 1;
            border-radius: 5px;
            height: 80%;
            background: transparent;
            border: none;
            outline: none;
            color: white;
            font-family: 'Roboto', sans-serif;
        }
        .checkbox input[type="checkbox"] {
            border-radius: 5px;
            width: 10%;
            height: 70%;
            margin: 1%;
        }
        .checkbox button {
            width: 28px;
            height: 28px;
            margin: 1%;
            border-radius: 50%;
            border: none;
            background-color: #ff4d4d;
            color: white;
            font-size: x-large;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        #append {
            margin: 15px;
            display: flex;
            justify-content: center;
            color: aqua;
            cursor: pointer;
        }
        #clearall {
            height: 3%;
            border-radius: 4px;
            border: none;
            background-color: #ff4d4d;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            font-family: 'Roboto', sans-serif;
        }
        .completed {
            text-decoration: line-through;
            color: #888;
        }
        #display {
            margin-top: 20px;
        }
        #clist li {
            color: #aaa;
        }
    </style>
</head>
<body ng-controller="ctrl">
    <div id="list">
        <input type="text" id="title" placeholder="Title" ng-model="listTitle" ng-change="saveToLocalStorage()">
        <div class="checkbox" ng-repeat="item in items track by $index">
            <input type="checkbox" ng-model="item.completed" ng-change="saveToLocalStorage()">
            <input type="text" placeholder="Enter Item" ng-model="item.task" ng-class="{'completed': item.completed}" ng-change="saveToLocalStorage()">
            <button ng-click="remove($index)">&times;</button>
        </div>
        <div id="append">
            <label ng-click="add()">+ Add Item</label>
        </div>
        <div id="display">
            <h3>Completed Tasks: {{ completedCount }}</h3>
            <ul id="clist">
                <li ng-repeat="item in items | filter:{completed:true}" ng-bind="item.task"></li>
            </ul>
        </div>
        <button id="clearall" ng-click="clearAll()">Clear All</button>
    </div>
    <script>
        angular.module('app', []).controller('ctrl', function($scope) {
            // Initialize items from local storage or default
            $scope.items = JSON.parse(localStorage.getItem('todoItems')) || [
                {"task": "First task", "completed": false},
                {"task": "Second task", "completed": false}
            ];
            $scope.listTitle = localStorage.getItem('todoListTitle') || '';

            // Save to local storage
            $scope.saveToLocalStorage = function() {
                localStorage.setItem('todoItems', JSON.stringify($scope.items));
                localStorage.setItem('todoListTitle', $scope.listTitle);
            };

            // Add new item
            $scope.add = function() {
                $scope.items.push({
                    task: "",
                    completed: false
                });
                $scope.saveToLocalStorage();
            };

            // Remove item
            $scope.remove = function(index) {
                $scope.items.splice(index, 1);
                $scope.saveToLocalStorage();
            };

            // Clear all items
            $scope.clearAll = function() {
                $scope.items = [];
                $scope.listTitle = '';
                $scope.saveToLocalStorage();
            };

            // Count completed tasks
            $scope.$watch('items', function() {
                $scope.completedCount = $scope.items.filter(function(item) {
                    return item.completed;
                }).length;
            }, true);
        });
    </script>
</body>
</html>